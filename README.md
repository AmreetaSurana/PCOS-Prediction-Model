# PCOS Prediction using Ensemble Learning

This project provides a robust, production-oriented pipeline for
screening Polycystic Ovary Syndrome (PCOS) using machine learning
techniques. The core deliverable is a reliable classifier built upon
advanced **ensemble methods** and enhanced with model interpretability
and deployment-ready artifacts.

## Project Overview

The **goal** of this project is to build a classifier that reliably
predicts PCOS (Polycystic Ovary Syndrome), a binary outcome, based on
clinical and demographic features. Given the nature of a screening task,
the evaluation focuses on maximizing **recall (sensitivity)** while
controlling false positives.

### Key Features

-   **Advanced Ensemble Modeling:** Implements a **stacking ensemble**
    using cross-validated meta-features for enhanced predictive
    performance.

-   **Reproducible Preprocessing:** Utilizes a **ColumnTransformer** and
    **Pipeline** for clean data handling, feature engineering, and
    reproducible preprocessing steps.

-   **Data Imbalance Handling:** Includes techniques such as **SMOTE
    variants** and **class weights** to address the imbalanced nature of
    the dataset.

-   **Model Interpretability (SHAP):** Provides **SHAP explanations** to
    understand feature importance and how the model arrives at its
    predictions.

-   **Deployment Artifacts:** Exports the final model and preprocessing
    pipeline as a saved artifact (joblib) and includes a **small
    Streamlit demo** for user-input predictions.

**Repository Structure & Notebooks**

  ---------------------------------------------------------------------------
  File                         Description
  ---------------------------- ----------------------------------------------
  **PCOS ensembling            The main, end-to-end notebook. It contains
  advanced.ipynb**             comprehensive EDA, preprocessing pipelines,
                               baseline model training, hyperparameter
                               tuning, advanced stacking ensemble creation,
                               SHAP analysis, and model export.

  **PCOS ensembling            A simpler notebook demonstrating an initial
  Basic.ipynb**                baseline model, specifically a **Random
                               Forest** classifier. This model achieved an
                               initial accuracy of 62.38%.

  pcos_final_pipeline.joblib   The exported, deployment-ready machine
                               learning pipeline (generated by the advanced
                               notebook).

  app.py                       Python script for the Streamlit web
                               application demo.
  ---------------------------------------------------------------------------

**Setup and Installation**

This project requires Python and several specialized libraries for
machine learning, data handling, and deployment.

1.  **Clone the repository:**

Bash

git clone \[your-repo-link\]

cd \[your-repo-name\]

2.  Install dependencies:

The following packages are essential (you may need to create a
requirements.txt based on the imports in the notebook):

Bash

\# Install standard data science libraries

pip install numpy pandas matplotlib scikit-learn joblib

\# Install specific dependencies mentioned in the advanced notebook

pip install xgboost imbalanced-learn shap mlflow streamlit

3.  **Data:** The PCOS ensembling advanced.ipynb notebook expects to
    load two concatenated datasets: LRwithinfert 1.csv and
    LRwithout_inferti 2.csv. Ensure you place your data files in a path
    accessible by the notebook and update the file path inside the
    notebook if necessary.

**How to Run the Project**

**1. Run the Notebooks**

Simply open and execute the Jupyter notebooks sequentially to view the
data analysis, model training, and evaluation steps.

-   PCOS ensembling Basic.ipynb (for baseline reference)

-   PCOS ensembling advanced.ipynb (for the full pipeline and ensemble
    model training)

**2. Run the Streamlit Demo**

The advanced notebook creates and exports the final model pipeline to a
file named pcos_final_pipeline.joblib. To run the small web application
demo that allows user-input predictions:

Bash

streamlit run app.py

The application will launch in your web browser and allow you to input
clinical data (such as Age) to get a real-time PCOS probability
prediction. (Note: The provided notebook snippet only shows \'Age\' as
an input example, ensure the app.py script matches all required features
from your trained pipeline).
